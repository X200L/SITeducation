# Делаем игру "Динозаврик" на Arduino: Просто и весело!

Привет! Помнишь игру "Динозаврик", которая появляется в Chrome, когда нет интернета? Давай сделаем что-то похожее на Arduino! Это будет просто, но интересно.

## Что нам понадобится?

*   Arduino (например, Arduino Uno)
*   LCD-дисплей 1602 (16 символов в строке, 2 строки)
*   I2C-модуль для LCD (чтобы меньше проводов)
*   Кнопка
*   Резистор (например, 10 кОм)
*   Соединительные провода
*   Немного терпения и энтузиазма!

## Подключаем всё к Arduino

Сначала нужно всё правильно подключить. Вот как это сделать:
![dino](images/ardudino.png)
1.  **LCD-дисплей:**
    *   Подключи I2C-модуль к LCD-дисплею.
    *   Подключи SDA к пину A4 на Arduino.
    *   Подключи SCL к пину A5 на Arduino.
    *   Подключи VCC к 5V на Arduino.
    *   Подключи GND к GND на Arduino.
2.  **Кнопка:**
    *   Подключи одну ножку кнопки к пину 2 на Arduino.
    *   Подключи другую ножку кнопки к GND через резистор (10 кОм). Это нужно, чтобы кнопка работала правильно.

## Устанавливаем библиотеку LiquidCrystal_I2C

Чтобы управлять LCD-дисплеем, нам понадобится специальная библиотека. Вот как её установить:

1.  Открой Arduino IDE.
2.  Перейди в "Sketch" -> "Include Library" -> "Manage Libraries...".
3.  Введи в поиске "LiquidCrystal_I2C" и установи библиотеку от Frank de Brabander.

## Пишем код

Теперь самое интересное — код! Вот пример кода для нашей игры:

```arduino
#include <LiquidCrystal_I2C.h>

// Настраиваем LCD
LiquidCrystal_I2C lcd(0x27, 16, 2);  // Укажи свой адрес, если 0x27 не работает

// Пин кнопки
const int buttonPin = 2;

// Символы для динозаврика и препятствия
byte dino[8] = {
  B00010,
  B00110,
  B01110,
  B11110,
  B11010,
  B01000,
  B10000,
  B11000
};

byte cactus[8] = {
  B00100,
  B00100,
  B01100,
  B11100,
  B01100,
  B01100,
  B01100,
  B00000
};

int dinoPos = 1;       // Начальная позиция динозаврика (ближе к левому краю)
int cactusPos = 15;     // Начальная позиция кактуса (дальше к правому краю)
bool isJumping = false; // Прыгает ли динозаврик (false - на земле, true - в прыжке)
int jumpHeight = 1;     // Высота прыжка (1 - земля, 0 - в прыжке)
int gameSpeed = 200;    // Скорость игры (чем меньше число, тем быстрее)
unsigned long lastJumpTime = 0; // Время последнего прыжка
const int jumpDuration = 500; // Длительность прыжка в миллисекундах

void setup() {
  lcd.init();         // Инициализируем LCD
  lcd.backlight();    // Включаем подсветку
  pinMode(buttonPin, INPUT_PULLUP); // Настраиваем кнопку (INPUT_PULLUP - встроенный подтягивающий резистор)

  // Создаем свои символы
  lcd.createChar(0, dino); // Создаем символ динозаврика (код 0)
  lcd.createChar(1, cactus); // Создаем символ кактуса (код 1)

  lcd.clear(); // Очищаем экран
  // Рисуем динозаврика на нижней строке (строка 1)
  lcd.setCursor(dinoPos, 1);
  lcd.write(byte(0));
}

void loop() {
  // Движение кактуса
  lcd.setCursor(cactusPos, 1); // Устанавливаем курсор на позицию кактуса на нижней строке
  lcd.print(" "); // Стираем кактус на старой позиции (заменяем пробелом)

  cactusPos--; // Двигаем кактус влево (уменьшаем позицию)

  // Если кактус дошел до края экрана, перемещаем его в начало
  if (cactusPos < 0) {
    cactusPos = 15; // Перемещаем кактус в начало (правый край экрана)
  }

  lcd.setCursor(cactusPos, 1); // Устанавливаем курсор на новую позицию кактуса
  lcd.write(byte(1)); // Рисуем кактус на новой позиции (используем код 1)

  // Обработка кнопки
  if (digitalRead(buttonPin) == LOW && !isJumping) {
    // Если кнопка нажата и динозаврик не прыгает
    isJumping = true; // Начинаем прыжок
    jumpHeight = 0; // Поднимаем динозаврика вверх
    lastJumpTime = millis(); // Запоминаем время начала прыжка
    
    // Обновляем позицию динозаврика
    lcd.setCursor(dinoPos, 1); // Стираем с нижней строки
    lcd.print(" ");
    lcd.setCursor(dinoPos, jumpHeight); // Рисуем на верхней строке
    lcd.write(byte(0));
  }

  // Управление прыжком
  if (isJumping && millis() - lastJumpTime > jumpDuration) {
    // Если прыжок длится дольше jumpDuration, завершаем его
    isJumping = false;
    jumpHeight = 1; // Возвращаем на землю
    
    // Обновляем позицию динозаврика
    lcd.setCursor(dinoPos, 0); // Стираем с верхней строки
    lcd.print(" ");
    lcd.setCursor(dinoPos, jumpHeight); // Рисуем на нижней строке
    lcd.write(byte(0));
  }

  // Проверка столкновения
  if (cactusPos == dinoPos && jumpHeight == 1) {
    // Если кактус и динозаврик находятся на одной позиции и динозаврик на земле
    lcd.clear(); // Очищаем экран
    lcd.setCursor(0, 0); // Устанавливаем курсор в начало экрана
    lcd.print("Game Over!"); // Выводим сообщение "Game Over!"
    delay(2000); // Ждем 2 секунды
    lcd.clear(); // Очищаем экран
    cactusPos = 15; // Перемещаем кактус в начало
    // Восстанавливаем динозаврика
    lcd.setCursor(dinoPos, 1);
    lcd.write(byte(0));
  }

  delay(gameSpeed); // Скорость игры (чем меньше число, тем быстрее)
}
```

## Что делает этот код? (Подробное объяснение)

Давай разберем код построчно, чтобы понять, что происходит:

*   **`#include <LiquidCrystal_I2C.h>`:** Эта строка подключает библиотеку, которая позволяет нам управлять LCD-дисплеем через I2C. Это как подключить специальный модуль, чтобы говорить с дисплеем на понятном ему языке.
*   **`LiquidCrystal_I2C lcd(0x27, 16, 2);`:** Здесь мы создаем объект `lcd`, который будет представлять наш дисплей. `0x27` — это адрес дисплея на шине I2C. Важно! Этот адрес может быть другим, поэтому, если у тебя ничего не работает, попробуй поискать правильный адрес для своего дисплея. 16 и 2 — это размеры дисплея (16 символов в строке, 2 строки).
*   **`const int buttonPin = 2;`:** Эта строка говорит Arduino, что кнопка подключена к цифровому пину 2. `const` означает, что это значение не будет меняться в процессе работы программы.
*   **`byte dino[8] = { ... };` и `byte cactus[8] = { ... };`:** Здесь мы создаем массивы, которые будут представлять наши спрайты (изображения) динозаврика и кактуса. Каждый элемент массива — это байт, который описывает одну строку изображения. `B00010` — это двоичное представление числа, где каждый бит соответствует пикселю на экране. 1 — пиксель включен, 0 — выключен.
*   **`int dinoPos = 1;`:** Это начальная позиция динозаврика по горизонтали. Мы ставим его немного левее, чтобы было место для прыжка.
*   **`int cactusPos = 15;`:** Это начальная позиция кактуса по горизонтали. Мы ставим его в самый правый край экрана.
*   **`bool isJumping = false;`:** Это флаг, который показывает, находится ли динозаврик в прыжке. `false` — на земле, `true` — в прыжке.
*   **`int jumpHeight = 1;`:** Это высота прыжка. В нашем случае 1 — это нижняя строка (земля), а 0 — верхняя строка (в прыжке).
*   **`int gameSpeed = 200;`:** Это скорость игры. Чем меньше число, тем быстрее двигается кактус.
*   **`unsigned long lastJumpTime = 0;`:** Это переменная для хранения времени последнего прыжка. Она нужна, чтобы динозаврик не прыгал бесконечно.
*   **`const int jumpDuration = 500;`:** Это длительность прыжка в миллисекундах.
*   **`void setup() { ... }`:** Это функция, которая выполняется один раз при запуске программы. Здесь мы инициализируем LCD, включаем подсветку, настраиваем кнопку и создаем свои символы.
    *   **`lcd.init();` и `lcd.backlight();`:** Инициализируют LCD-дисплей и включают подсветку.
    *   **`pinMode(buttonPin, INPUT_PULLUP);`:** Настраивает пин кнопки как вход с подтягивающим резистором. Это значит, что когда кнопка не нажата, на пине будет HIGH (5V), а когда нажата — LOW (0V).
    *   **`lcd.createChar(0, dino);` и `lcd.createChar(1, cactus);`:** Создают свои символы для динозаврика и кактуса. Теперь мы можем использовать `lcd.write(byte(0))` и `lcd.write(byte(1))` для рисования этих символов на экране.
    *   **`lcd.clear();`:** Очищает экран.
    *   **`lcd.setCursor(dinoPos, 1);`:** Устанавливает курсор на позицию динозаврика (нижняя строка, позиция 1).
    *   **`lcd.write(byte(0));`:** Рисует динозаврика на экране.
*   **`void loop() { ... }`:** Это основная функция, которая выполняется постоянно. В ней происходит всё самое интересное:
    *   **Движение кактуса:**
        *   `lcd.setCursor(cactusPos, 1);` Устанавливаем курсор на позицию кактуса на нижней строке.
        *   `lcd.print(" ");` Стираем кактус на старой позиции (заменяем пробелом).
        *   `cactusPos--;` Двигаем кактус влево (уменьшаем позицию).
        *   `if (cactusPos < 0) { cactusPos = 15; }` Если кактус дошел до края экрана, перемещаем его в начало.
        *   `lcd.setCursor(cactusPos, 1);` Устанавливаем курсор на новую позицию кактуса.
        *   `lcd.write(byte(1));` Рисуем кактус на новой позиции.
    *   **Обработка кнопки:**
        *   `if (digitalRead(buttonPin) == LOW && !isJumping) { ... }` Проверяем, нажата ли кнопка и не прыгает ли динозаврик уже.
        *   `isJumping = true;` Начинаем прыжок.
        *   `jumpHeight = 0;` Поднимаем динозаврика вверх.
        *   `lastJumpTime = millis();` Запоминаем время начала прыжка.
        *   `lcd.setCursor(dinoPos, 1); lcd.print(" ");` Стираем динозаврика с нижней строки.
 	    *   `lcd.setCursor(dinoPos, jumpHeight); lcd.write(byte(0));` Рисуем динозаврика на верхней строке.
    *   **Управление прыжком:**
        *   `if (isJumping && millis() - lastJumpTime > jumpDuration) { ... }` Проверяем, прыгает ли динозаврик и не прошло ли достаточно времени с начала прыжка.
        *   `isJumping = false;` Заканчиваем прыжок.
        *   `jumpHeight = 1;` Возвращаем динозаврика на землю.
        *   `lcd.setCursor(dinoPos, 0); lcd.print(" ");` Стираем динозаврика с верхней строки.
        *   `lcd.setCursor(dinoPos, jumpHeight); lcd.write(byte(0));` Рисуем динозаврика на нижней строке.
    *   **Проверка столкновения:**
        *   `if (cactusPos == dinoPos && jumpHeight == 1) { ... }` Проверяем, находится ли кактус на той же позиции, что и динозаврик, и находится ли динозаврик на земле.
        *   `lcd.clear();` Очищаем экран.
        *   `lcd.setCursor(0, 0); lcd.print("Game Over!");` Выводим сообщение "Game Over!".
        *   `delay(2000);` Ждем 2 секунды.
        *   `lcd.clear();` Очищаем экран.
        *   `cactusPos = 15;` Перемещаем кактус в начало.
        *   `lcd.setCursor(dinoPos, 1); lcd.write(byte(0));` Восстанавливаем динозаврика.
    *   **`delay(gameSpeed);`:** Задержка, которая определяет скорость игры.

## Как работает логика игры?

1.  **Движение кактуса:** Мы уменьшаем позицию кактуса (`cactusPos--`) каждый кадр. Когда кактус доходит до края экрана (`cactusPos < 0`), мы перемещаем его в начало (`cactusPos = 15`). Это создает иллюзию бесконечного движения.
2.  **Прыжок:** Когда кнопка нажата, мы устанавливаем `isJumping = true` и `jumpHeight = 0`. Мы также запоминаем время начала прыжка (`lastJumpTime = millis();`). Затем, в каждом кадре, мы проверяем, прошло ли достаточно времени с начала прыжка (`millis() - lastJumpTime > jumpDuration`). Если прошло, мы заканчиваем прыжок и возвращаем динозаврика на землю.
3.  **Столкновение:** Мы проверяем, находится ли кактус на той же позиции, что и динозаврик (`cactusPos == dinoPos`) и находится ли динозаврик на земле (`jumpHeight == 1`). Если оба условия выполнены, игра заканчивается.

## Как играть?

1.  Загрузи код на Arduino.
2.  Нажимай на кнопку, чтобы динозаврик прыгал и избегал кактусов.
3.  Наслаждайся своей мини-игрой!

## Что можно улучшить?

*   **Сделать счет:** Добавь счетчик очков за каждый успешно избежавший кактус.
*   **Увеличивать скорость:** Постепенно увеличивай скорость игры, чтобы было сложнее.
*   **Добавить больше препятствий:** Добавь птичек или другие препятствия.
*   **Сделать графику лучше:** Попробуй создать более детализированные символы для динозаврика и кактуса.

## Заключение

Вот и всё! Мы сделали простую, но забавную игру "Динозаврик" на Arduino. Это отличный способ научиться работать с LCD-дисплеем, кнопками и создавать свои игры. Удачи в твоих проектах!
